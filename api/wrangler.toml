name = "saas-api"
main = "src/index.ts"
compatibility_date = "2024-11-01"
compatibility_flags = []
workers_dev = true

[vars]
ENV_NAME = "local-or-default"

[durable_objects]
[[durable_objects.bindings]]
name = "SLOT_LOCK"
class_name = "SlotLockV3"

[observability]
enabled = true

# ---------- STAGING ----------
[env.staging]
name = "saas-api-staging-v4"
workers_dev = true

[env.staging.vars]
ENV_NAME = "staging"

# ※ kv_namespaces は「配列のテーブル」記法
[[env.staging.kv_namespaces]]
binding = "LINE_BOOKING"
id = "b79b8cf60453429097de6c6c85f8c229"   # ← 後で入れてOK。今は空のままでもデプロイ可能

[env.staging.durable_objects]
[[env.staging.durable_objects.bindings]]
name = "SLOT_LOCK"
class_name = "SlotLockV3"

[env.staging.observability]
enabled = true

# ---------- PRODUCTION ----------
[env.production]
name = "saas-api-v4"
workers_dev = true

[env.production.vars]
ENV_NAME = "production"

[[env.production.kv_namespaces]]
binding = "LINE_BOOKING"
id = "bdcf5fd8d8034c498c2bc1375a657c24"   # ← 後で入れてOK。今は空のままでもデプロイ可能

[env.production.durable_objects]
[[env.production.durable_objects.bindings]]
name = "SLOT_LOCK"
class_name = "SlotLockV3"

[env.production.observability]
enabled = true

# （任意）Warning消したければ DO migrations を追加

[[migrations]]
tag = "v1"
new_sqlite_classes = ["SlotLockV3"]
preview_urls = false


