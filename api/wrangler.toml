name = "saas-api"
main = "src/index.ts"
compatibility_date = "2024-11-01"   # だいたいでOK（あなたの現状に合わせて）
# compatibility_flags = ["nodejs_compat"]  # 必要なら

[durable_objects]
bindings = [
  { name = "SLOT_LOCK", class_name = "SlotLockV2" }
]

# --- ここ重要： new_sqlite_classes で DO を「作成」する ---
[[migrations]]
tag = "v1-slotlock-sqlite"
new_sqlite_classes = ["SlotLockV2"]

# （既存の staging/prod セクションはそのままでOK）
[env.staging]
vars = { BASE_URL = "https://saas-api-staging.hekuijincun.workers.dev", ADMINS = "U929e7fcc7a5ed0c4bcbd0c4c9b001815" }

[env.production]
vars = { BASE_URL = "https://saas-api.hekuijincun.workers.dev", ADMINS = "U929e7fcc7a5ed0c4bcbd0c4c9b001815" }
